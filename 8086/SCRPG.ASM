TITLE Scrolling

	.MODEL SMALL
	.STACK 256
	.DATA

	ROW1 DB 00
	ROW2 DB 24
	COL1 DB 00
	COL2 DB 79
	ROWT DB 00
	COLT DB 00
	PG DB 00
	.CODE

MAIN PROC FAR

	MOV AX,@DATA
	MOV DS,AX
	MOV AH,05H
	MOV AL,PG
	INT 10H

	MOV AX,0600H
	CALL SETSCREEN

	CALL SETCURSOR

	M10:;LOOP FOR TAKING INPUT
	MOV AH,01H
	INT 21H
	INC COLT
	CMP COLT,80D;CHECK END OF LINE
	JNZ M20
	MOV COLT,00
	INC ROWT
	CALL SETCURSOR
	M20:
	CMP AL,0DH; CHECK FOR ENTER
	JNZ M30
	INC ROWT
	MOV COLT,00
	CALL SETCURSOR
	M30:; CHECK FOR BACKSPACE
	CMP AL,08H
	JNZ M50
	DEC COLT
	DEC COLT
	CMP COLT,00; CHECK IF BACKSPACE+START OF LINE
	JNZ M40
	MOV COLT,78D
	DEC ROWT
	JMP M40
	DUMMY:
	JMP M10
	M40:
	CALL SETCURSOR
	MOV AH,02H
	MOV DL,' '
	INT 21H
	CALL SETCURSOR
	JMP M60; CHECK FOR UPSCROLLING
	M50: ;RET IF ESC
	MOV DH,ROW2
	CMP ROWT,DH; CHECK IF TO SCROLL
	JBE M60
	DEC ROWT
	MOV ROWT,00
	MOV COLT,00
	INC PG
	MOV AH,05H
	MOV AL,PG
	INT 10H
	CALL SETCURSOR
	MOV AX,0600H
	CALL SETSCREEN
	JMP M70
	M60:
	MOV DH,ROW1
	CMP ROWT,DH; CHECK IF TO SCROLL UP
	JAE M70
	INC ROWT
	CALL SETCURSOR
	MOV AX,0701H
	CALL SETSCREEN
	M70:
	CMP AL,1BH
	JNZ DUMMY
	

	MOV AH,4CH
	INT 21H

MAIN ENDP

SETSCREEN PROC NEAR
	
	MOV BH,35H
	MOV CH,ROW1
	MOV CL,COL1
	MOV DH,ROW2
	MOV DL,COL2
	INT 10H

	RET
SETSCREEN ENDP

SETCURSOR PROC NEAR

	MOV AH,02H;FN FOR SETTING CURSOR
	MOV BH,PG
	MOV DH,ROWT
	MOV DL,COLT
	INT 10H

RET

SETCURSOR ENDP

END MAIN